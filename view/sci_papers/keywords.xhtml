<form class="form-inline" accept-charset="UTF-8" action="authors_create" method="post">
<div class="control-group">
<label class="control-label">Keywords:</label>
<div class="controls"><small>Keywords will be used to find publications at the NP web. </small>
</div>
<br />

<div id="content_list">

<div class="top_first">
<ul id="sortable">
<div id="first" name="first">
<span>
<input id="author0" name="author0">
<span class="btn btn-mini" name="span_sibling3_first" id="span_sibling3_first" id="delete_first" onClick="add_remove_author(this);">Delete</span>
</span>
</div>

<span id="writefield" name="writefield"></span>
</ul>

</div>

<div id="readfield" name="readfield" style="display: none">
<input id="author" name="author">
<span class="btn btn-mini" name="span_sibling3" id="span_sibling3" onClick="add_remove_author(this);">Delete</span>
</div>

<p>&nbsp;</p>
<div class="controls">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button class="btn btn-primary" name="add_author" id="add_author" onClick="add_remove_author(this); return false" />Add keyword</button>
</div>
</div>


<div id="authors_id" >#{ render_partial :save_or_back }</div>


<script type='text/javascript'>
$(function() {
  var availableAuthors = #@author;
  //alert(availableAuthors);

  for (var i=0;i<10;i++) {
      var auth = "#author" + i.toString();
      //alert(auth); 
     $(auth).autocomplete({
     source: availableAuthors });
  }

});
</script>

<script type='text/javascript'>
var numb = 0;

function add_autocomplete(elem) {
    var availableAuthors = #@author;
    alert(availableAuthors);
    var auth = elem.id;
    alert(auth);
    $(auth).autocomplete({
    source: availableAuthors });
    
}

function printObject(o) {
  alert(o);
  var out = '';
 /* for (var p in o) {
     out += p + ': ' + o[p] + '\n';
  } */
  alert(out);
}

function add_remove_author(elem) {
    //alert(elem.parentNode);
    //alert(elem.parentNode.parentNode.parentNode.id);
    alert(numb);
    

 if (elem.id == "add_author") {  //Add an author field
    numb++;
    var newFields2 = document.getElementById('readfield').cloneNode(true);
    alert(newFields2.id);
    newFields2.name = 'readfield' + numb;
    newFields2.id = 'readfield' + numb;
  
   

    //Get input element (author) 
    alert(newFields2.firstChild.id)
    //var author = newFields2.lastChild.id;

    var author = document.getElementById('author');
    alert(author.id);
    author.name = 'author' + numb;
    alert(author.name);
    author.id = 'author' + numb;

    printObject(newFields2);

    newFields2.style.display = 'block'; //Make visible
        
    var insertHere = document.getElementById('writefield');
    insertHere.parentNode.insertBefore(newFields2,insertHere);
    //add_autocomplete(author);
  
 } else { //Remove a field
    var div_elem = elem.parentNode.id;
    alert(div_elem);
    var newFields = document.getElementById(div_elem);
    alert(newFields);
    newFields.parentNode.removeChild(newFields);
    
 }
  

}
</script>


</div>
</form>
